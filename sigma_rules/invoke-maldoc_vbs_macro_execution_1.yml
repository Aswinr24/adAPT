title: Invoke-MalDoc VBS Macro Execution
id: 8a116d5f-d1ce-4b18-85e6-957c2fa5ccb3
status: stable
description: 'Detects Invoke-MalDoc PowerShell function execution for VBS macro execution.

  APT36 downloads and executes Invoke-MalDoc to create malicious Office documents
  with embedded macros.

  Monitors PowerShell script blocks for Invoke-MalDoc with VBS macro file patterns.'
author: []
date: '2025-12-09'
modified: '2025-12-08'
references: []
tags:
- Windows
- MITRE
- attack.ta0002
- attack.execution
- APT36
- attack.t1204
level: high
logsource:
  category: process_creation
  product: windows
  index:
  - winlogbeat-*
detection:
  selection:
    keywords:
    - "host.os.type: \"windows\" AND\nevent.code: \"600\" AND\nprocess.command_line:\
      \ (\n  (*IEX* OR *Invoke-Expression*) AND\n  (*iwr* OR *Invoke-WebRequest*)\
      \ AND\n  *-UseBasicParsing* AND\n  (*Invoke-Maldoc* OR *Invoke-MalDoc*)\n) AND\n\
      process.command_line: (\n  *choice* AND */C* AND */N* AND */D* AND */T*\n)"
  condition: selection
falsepositives:
- Unknown
fields: []
