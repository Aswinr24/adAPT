title: Potential Sudo Privilege Escalation via CVE-2019-14287
id: 8af5b42f-8d74-48c8-a8d0-6d14b4197288
status: stable
description: This rule monitors for the execution of a suspicious sudo command that
  is leveraged in CVE-2019-14287 to escalate privileges to root. Sudo does not verify
  the presence of the designated user ID and proceeds to execute using a user ID that
  can be chosen arbitrarily. By using the sudo privileges, the command "sudo -u#-1"
  translates to an ID of 0, representing the root user. This exploit may work for
  sudo versions prior to v1.28.
author:
- Elastic
date: '2025-12-09'
modified: '2025-12-05'
references:
- https://www.exploit-db.com/exploits/47502
tags:
- attack.t1068
- 'Tactic: Privilege Escalation'
- attack.ta0004
- 'Data Source: Crowdstrike'
- 'Data Source: SentinelOne'
- 'OS: Linux'
- 'Use Case: Threat Detection'
- 'Resources: Investigation Guide'
- 'Use Case: Vulnerability'
- 'Data Source: Auditd Manager'
- 'Data Source: Elastic Defend'
- 'Domain: Endpoint'
- 'Data Source: Elastic Endgame'
- attack.privilege_escalation
level: medium
logsource:
  category: process_creation
  product: linux
  index:
  - auditbeat-*
  - endgame-*
  - logs-auditd_manager.auditd-*
  - logs-crowdstrike.fdr*
  - logs-endpoint.events.process*
  - logs-sentinel_one_cloud_funnel.*
detection:
  selection:
    eql_query: "process where host.os.type == \"linux\" and event.type == \"start\"\
      \ and\n  event.action in (\"exec\", \"exec_event\", \"start\", \"ProcessRollup2\"\
      , \"executed\", \"process_started\") and\n  process.name == \"sudo\" and process.args\
      \ == \"-u#-1\"\n"
  condition: selection
falsepositives:
- Unknown
fields:
- event.action
- event.type
- host.os.type
- process.args
- process.name
